```{r}
getwd()
tract<-read.csv("Tractor-Sales (1).csv")
View(tract)
```
```{r}
tr<-ts(tract[,2],start =2003,frequency = 12)
plot(tr)
```
```{r}
dtr<-stl(tr,s.window = "periodic")
dtr
```
Call:
    stl(x = tr, s.window = "periodic")

> Components
seasonal    trend   remainder
Jan 2003 : -67.280792 172.4155  35.8652537
Feb 2003 -63.421182 172.3386  48.0826023
Mar 2003  -1.978228 172.2616  14.7166081
Apr 2003  28.400185 173.0856  -2.4858315
May 2003  70.778609 173.9097 -41.6882824
Jun 2003  48.176675 175.0127 -34.1894114
Jul 2003 101.324723 176.1158 -70.4405239
Aug 2003  98.345514 176.8302 -68.1756995
Sep 2003 -14.967014 177.5446   8.4224441
Oct 2003 -63.732045 180.2490  33.4830716
Nov 2003 -93.997069 182.9534  49.0436931
Dec 2003 -41.649376 185.1917  21.4577114
Jan 2004 -67.280792 187.4300  24.8508399
Feb 2004 -63.421182 187.6443  43.7768383
Mar 2004  -1.978228 187.8587  11.1194939
Apr 2004  28.400185 187.6559  -8.0561014
May 2004  70.778609 187.4531 -48.2317082
Jun 2004  48.176675 189.4158 -28.5924965
Jul 2004 101.324723 191.3785 -54.7032683
Aug 2004  98.345514 196.1730 -56.5185362
Sep 2004 -14.967014 200.9675  12.9995151
Oct 2004 -63.732045 207.3414  24.3905949
Nov 2004 -93.997069 213.7154  32.2816688
Dec 2004 -41.649376 218.6174  19.0319717
Jan 2005 -67.280792 223.5194  26.7613848
Feb 2005 -63.421182 225.4549  37.9662479
Mar 2005  -1.978228 227.3905  23.5877682
Apr 2005  28.400185 228.4462  -5.8463516
May 2005  70.778609 229.5019 -11.2804828
Jun 2005  48.176675 231.8664 -31.0430586
Jul 2005 101.324723 234.2309 -56.5556180
Aug 2005  98.345514 237.9818 -57.3273497
Sep 2005 -14.967014 241.7328   5.2342376
Oct 2005 -63.732045 246.1961  21.5359157
Nov 2005 -93.997069 250.6595  37.3375878
Dec 2005 -41.649376 254.6457  19.0037153
Jan 2006 -67.280792 258.6318  23.6489530
Feb 2006 -63.421182 260.9306  41.4905649
Mar 2006  -1.978228 263.2294   8.7488340
Apr 2006  28.400185 264.6637 -14.0639306
May 2006  70.778609 266.0981 -29.8767066
Jun 2006  48.176675 268.6484 -11.8250369
Jul 2006 101.324723 271.1986 -50.5233507
Aug 2006  98.345514 275.8811 -35.2265795
Sep 2006 -14.967014 280.5635  -2.5964892
Oct 2006 -63.732045 287.1059  17.6260949
Nov 2006 -93.997069 293.6484  29.3486731
Dec 2006 -41.649376 299.0527  14.5966928
Jan 2007 -67.280792 304.4570   9.8238228
Feb 2007 -63.421182 307.0436  17.3775575
Mar 2007  -1.978228 309.6303  22.3479493
Apr 2007  28.400185 310.3958  23.2040369
May 2007  70.778609 311.1613   3.0601131
Jun 2007  48.176675 311.4402 -19.6169206
Jul 2007 101.324723 311.7192 -43.0439378
Aug 2007  98.345514 311.9349 -29.2804407
Sep 2007 -14.967014 312.1506   1.8163756
Oct 2007 -63.732045 313.1986  16.5334675
Nov 2007 -93.997069 314.2465  18.7505534
Dec 2007 -41.649376 316.5597   6.0896675
Jan 2008 -67.280792 318.8729   5.4078919
Feb 2008 -63.421182 320.9994  -7.5782315
Mar 2008  -1.978228 323.1259   7.8523022
Apr 2008  28.400185 325.0527  -3.4529019
May 2008  70.778609 326.9795  -4.7581175
Jun 2008  48.176675 330.2286  -8.4053211
Jul 2008 101.324723 333.4778 -11.8025083
Aug 2008  98.345514 338.0540 -26.3995253
Sep 2008 -14.967014 342.6302  -1.6632232
Oct 2008 -63.732045 348.0592   4.6728024
Nov 2008 -93.997069 353.4882  10.5088221
Dec 2008 -41.649376 359.6556   2.9938157
Jan 2009 -67.280792 365.8229   6.4579197
Feb 2009 -63.421182 371.6902   1.7309502
Mar 2009  -1.978228 377.5576  -1.5793622
Apr 2009  28.400185 382.4460   3.1538069
May 2009  70.778609 387.3344  -4.1130355
Jun 2009  48.176675 391.9913   0.8320530
Jul 2009 101.324723 396.6481  12.0271579
Aug 2009  98.345514 401.7403 -14.0858027
Sep 2009 -14.967014 406.8325   1.1345558
Oct 2009 -63.732045 412.6337  -3.9016308
Nov 2009 -93.997069 418.4349  -9.4378232
Dec 2009 -41.649376 424.8750   5.7743305
Jan 2010 -67.280792 431.3152  -6.0344056
Feb 2010 -63.421182 437.3557  -5.9345442
Mar 2010  -1.978228 443.3963   2.5819744
Apr 2010  28.400185 447.9863   5.6135166
May 2010  70.778609 452.5763  10.6450474
Jun 2010  48.176675 455.8309  19.9924526
Jul 2010 101.324723 459.0854  17.5898743
Aug 2010  98.345514 461.9481   6.7063370
Sep 2010 -14.967014 464.8109  -2.8438811
Oct 2010 -63.732045 468.4774 -18.7453184
Nov 2010 -93.997069 472.1438 -18.1467616
Dec 2010 -41.649376 477.6858  -8.0364300
Jan 2011 -67.280792 483.2278 -18.9469880
Feb 2011 -63.421182 490.0723 -26.6511367
Mar 2011  -1.978228 496.9169   3.0613719
Apr 2011  28.400185 502.8679   4.7318664
May 2011  70.778609 508.8190  16.4023495
Jun 2011  48.176675 512.4264  30.3969646
Jul 2011 101.324723 516.0337  33.6415963
Aug 2011  98.345514 517.0372  38.6172372
Sep 2011 -14.967014 518.0408   5.9261971
Oct 2011 -63.732045 517.4984 -16.7663901
Nov 2011 -93.997069 516.9561 -16.9589832
Dec 2011 -41.649376 517.8226  -6.1732607
Jan 2012 -67.280792 518.6892 -23.4084279
Feb 2012 -63.421182 521.6892 -35.2679825
Mar 2012  -1.978228 524.6891 -15.7108800
Apr 2012  28.400185 527.6801 -20.0802817
May 2012  70.778609 530.6711   8.5503052
Jun 2012  48.176675 532.6143  28.2090407
Jul 2012 101.324723 534.5575  51.1177927
Aug 2012  98.345514 536.7130  71.9414471
Sep 2012 -14.967014 538.8686 -14.9015794
Oct 2012 -63.732045 542.2351 -26.5030953
Nov 2012 -93.997069 545.6017 -39.6046171
Dec 2012 -41.649376 551.0339 -37.3845553
Jan 2013 -67.280792 556.4662 -35.1853832
Feb 2013 -63.421182 564.3576 -45.9364284
Mar 2013  -1.978228 572.2490  -2.2708165
Apr 2013  28.400185 580.7648   0.8350463
May 2013  70.778609 589.2805  45.9408977
Jun 2013  48.176675 595.8997  16.9236170
Jul 2013 101.324723 602.5189  63.1563527
Aug 2013  98.345514 606.3221  78.3323933
Sep 2013 -14.967014 610.1253 -12.1582470
Oct 2013 -63.732045 613.5969 -36.8648662
Nov 2013 -93.997069 617.0686 -42.0714912
Dec 2013 -41.649376 623.2660 -14.6165841
Jan 2014 -67.280792 629.4634 -37.1825668
Feb 2014 -63.421182 637.9528 -54.5316547
Mar 2014  -1.978228 646.4423 -57.4640854
Apr 2014  28.400185 651.4637  30.1361154
May 2014  70.778609 656.4851  65.7363048
Jun 2014  48.176675 661.0008  39.8225344
Jul 2014 101.324723 665.5165 104.1587804
Aug 2014  98.345514 670.1858  79.4687348
Sep 2014 -14.967014 674.8550 -19.8879918
Oct 2014 -63.732045 678.6095 -33.8774547
Nov 2014 -93.997069 682.3640 -69.3669234
Dec 2014 -41.649376 685.0216 -38.3722663
```{r}
plot(dtr)
```
```{r}
ndiffs(tr)
```
[1] 1
```{r}
nsdiffs(tr)
```
[1] 1
```{r}
ggsubseriesplot(st)+ylab("sales")+ggtitle("seasonal plot:")
```
```{r}
autoplot(tr, series="Data") +
  autolayer(ma(tr, 12), series="12-MA") +
  xlab("Year") + ylab("sales") +
  ggtitle("sales") +
  scale_colour_manual(values=c("Data"="grey","12-MA"="red"),
                      breaks=c("Data","12-MA"))
```
```{r}
boxplot(tr~cycle(tr))
```
```{r}
acf(tr,lag(24))
```
```{r}
y<-diff(tr,lag=12)
plot(y)
```
```{r}
x<-log(tr)
plot(x)
```
```{r}
auto_tract<-auto.arima(log10(tr),stepwise = FALSE,approximation = FALSE)
summary(auto_tract)
```
Series: log10(tr) 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
    ma1     sma1
-0.4047  -0.5529
s.e.   0.0885   0.0734

sigma^2 estimated as 0.0002571:  log likelihood=354.4
AIC=-702.79   AICc=-702.6   BIC=-694.17

Training set error measures:
    ME       RMSE        MAE         MPE      MAPE
Training set 0.0002410698 0.01517695 0.01135312 0.008335713 0.4462212
MASE       ACF1
Training set 0.2158968 0.01062604
```{r}
ggtsdisplay(residuals(auto_tract))
```
```{r}
checkresiduals(auto_tract)
```
```{r}
res<-residuals(auto_tract)
Box.test(res,lag = 24,type = "Ljung")
```
Box-Ljung test

data:  res
X-squared = 26.219, df = 24, p-value = 0.3422
#prediction
```{r}
par(mfrow = c(1,1))
Pred= predict(auto_tract, n.ahead = 36)
Pred
plot(tr,type='l',xlim=c(2004,2018),ylim=c(1,1600),xlab = 'Year',ylab = 'Tractor Sales')
lines(10^(Pred$pred),col='red')
lines(10^(Pred$pred+2*Pred$se),col='blue')
lines(10^(Pred$pred-2*Pred$se),col='orange')
```
